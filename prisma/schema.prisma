datasource db {
  provider = "postgresql"
}

generator client {
  provider = "prisma-client"
  output   = "../generated/prisma"
}
//////////////////////////////////////
// ENUMS
//////////////////////////////////////

enum UserRole {
  ADMIN
  EDITOR
  MEMBER
}

enum ContentType {
  OPED
  ANNOUNCEMENT
  VIDEO
  GALLERY
  EMAGAZINE
}

enum ContentStatus {
  DRAFT
  PUBLISHED
  ARCHIVED
}

enum MediaType {
  IMAGE
  VIDEO
  PDF
  YOUTUBE
}

//////////////////////////////////////
// USERS
//////////////////////////////////////

model User {
  id        String   @id @default(cuid())
  name      String
  email     String   @unique
  role      UserRole @default(MEMBER)

  contents  Content[]
  comments  Comment[]

  createdAt DateTime @default(now())
}

//////////////////////////////////////
// CONTENT
//////////////////////////////////////

model Content {
  id          String        @id @default(cuid())
  type        ContentType
  status      ContentStatus @default(DRAFT)

  title       String
  slug        String        @unique
  body        String?

  author      User?         @relation(fields: [authorId], references: [id])
  authorId    String?

  media       Media[]
  comments    Comment[]

  publishedAt DateTime?
  createdAt   DateTime      @default(now())
  updatedAt   DateTime      @updatedAt

  @@index([type])
  @@index([status])
}

//////////////////////////////////////
// MEDIA (URL ONLY)
//////////////////////////////////////

model Media {
  id          String    @id @default(cuid())
  type        MediaType

  url         String    // final CDN / R2 URL
  mimeType    String?
  size        Int?

  content     Content? @relation(fields: [contentId], references: [id])
  contentId   String?

  createdAt   DateTime  @default(now())

  @@index([type])
}

//////////////////////////////////////
// COMMENTS
//////////////////////////////////////

model Comment {
  id        String   @id @default(cuid())
  text      String

  content   Content  @relation(fields: [contentId], references: [id])
  contentId String

  user      User?    @relation(fields: [userId], references: [id])
  userId    String?

  createdAt DateTime @default(now())
}

//////////////////////////////////////
// EVENTS
//////////////////////////////////////

model Event {
  id          String   @id @default(cuid())
  title       String
  description String

  imageUrl    String?

  date        DateTime
  time        String
  location    String?

  createdAt   DateTime @default(now())
}

//////////////////////////////////////
// MEMBERS
//////////////////////////////////////

model Member {
  id           String   @id @default(cuid())
  name         String
  role         String
  bio          String?

  profileImageUrl String?

  createdAt   DateTime @default(now())
}

//////////////////////////////////////
// SUBSCRIPTIONS
//////////////////////////////////////

model Subscription {
  id        String   @id @default(cuid())
  email     String   @unique
  source    String?
  createdAt DateTime @default(now())
}
